document.addEventListener('DOMContentLoaded', async () => {
  // Fetch products from the blockchain
  const products = await fetchProductsFromBlockchain();
  const productList = document.getElementById('product-list');

  products.forEach(product => {
    const productItem = document.createElement('div');
    productItem.className = 'product-item';
    productItem.innerHTML = `
      <h2>${product.name}</h2>
      <p>Price: ${product.priceInEth} ETH</p>
      <p>Quantity: ${product.quantity}</p>
      <button onclick="addToCart('${product.name}', ${product.priceInEth}, ${product.quantity})">Add to Cart</button>
    `;
    productList.appendChild(productItem);
  });
});

async function fetchProductsFromBlockchain() {
  // Fetch products from your smart contract
  // Replace the placeholder with actual Web3 interaction
  // Assuming 'app.js' will handle Web3 integration
  // Placeholder implementation for demo purposes
  return [
    { name: 'Kava Root', priceInEth: 0.1, quantity: 10 },
    { name: 'Kava Powder', priceInEth: 0.05, quantity: 20 },
  ];
}

// Attach addToCart function to the global window object
window.addToCart = async function(name, priceInEth, quantity) {
  // Add product to cart
  console.log(`Added ${name} to cart`);
  // Assuming 'app.js' has the logic to interact with Web3
  try {
    await addToCartToBlockchain(name, priceInEth, quantity);
  } catch (error) {
    console.error('Failed to add to cart:', error);
  }
}

// Example function for blockchain interaction (to be defined in 'app.js')
async function addToCartToBlockchain(name, priceInEth, quantity) {
  // This function should interact with the smart contract
  // Placeholder for demonstration
  console.log(`Would interact with smart contract to add ${name} to cart.`);
}
